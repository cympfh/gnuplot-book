<!DOCTYPE HTML>
<html lang="ja" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>gnuplot-book</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">gnuplot-book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gnuplot-book"><a class="header" href="#gnuplot-book">gnuplot-book</a></h1>
<h2 id="version"><a class="header" href="#version">Version</a></h2>
<pre><code class="language-bash">   gnuplot -v

        G N U P L O T
        Version 5.2 patchlevel 2    last modified 2017-11-01

        Copyright (C) 1986-1993, 1998, 2004, 2007-2017
        Thomas Williams, Colin Kelley and many others

        gnuplot home:     http://www.gnuplot.info
        faq, bugs, etc:   type "help FAQ"
        immediate help:   type "help"  (plot window: hit 'h')
</code></pre>
<h2 id="reference"><a class="header" href="#reference">Reference</a></h2>
<ul>
<li><a href="http://gnuplot.info/documentation.html">documentation</a>
<ul>
<li>日本語版もあるので pdf の一読をお勧めします</li>
</ul>
</li>
<li><a href="http://gnuplot.info/demo/">gnuplot.info/demo</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="データブロック"><a class="header" href="#データブロック">データブロック</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="データの段落分け-index"><a class="header" href="#データの段落分け-index">データの段落分け, index</a></h1>
<p>段落に分けることで異なるデータを一つのファイルに含めることができる.
段落は <strong>2</strong> つの空行で区切る.
段落は block と呼ばれる.
各 block には名前を与えることが出来る.</p>
<p><code>index</code> はこの内, プロットに用いるブロックを選択することが出来る.
ブロックの指定は番号かまたはデータに名前をつけることでその名前でも指定することもできる.</p>
<p><a href="datablock/every.html">every</a> はコレとよく似ているが異なるデータフォーマットに対してより細かなデータの指定が出来る.</p>
<h2 id="data-format"><a class="header" href="#data-format">Data Format</a></h2>
<p>データは <strong>2行</strong> の空行で区切る.
データは先頭から 0-start の index が与えられる.
データの先頭にコメントで名前 (<code>&lt;data_name&gt;</code>) を与えられる.</p>
<pre><code class="language-dat"># data1
x1 y1
x2 y2
x3 y3


# data2
x1 y1
x2 y2
x3 y3
</code></pre>
<h2 id="index-keyword"><a class="header" href="#index-keyword"><code>index</code> keyword</a></h2>
<p>次の2種類の使い方がある.</p>
<pre><code class="language-bash">plot ... index &lt;start_index&gt;{:&lt;end_index&gt;{:&lt;index_incr&gt;}}
plot ... index &lt;data_name&gt;
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>params</th><th>default</th><th>value</th><th>explanation</th></tr></thead><tbody>
<tr><td><code>start_index</code></td><td></td><td>(int) index</td><td>読む block の最初 (0-indexed)</td></tr>
<tr><td><code>end_index</code></td><td>start_index</td><td>(int) index</td><td>読む block の最後 (0-indexed)</td></tr>
<tr><td><code>index_incr</code></td><td>1</td><td>(int)</td><td>start_index から end_index までの範囲にステップを与える</td></tr>
<tr><td><code>data_name</code></td><td></td><td>(string)</td><td>この名前のデータをプロットに使う</td></tr>
</tbody></table>
</div>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<h3 id="source-code"><a class="header" href="#source-code">Source Code</a></h3>
<p>段落番号 (<code>start_index</code>) で指定する方法</p>
<pre><code class="language-bash">plot 'index.dat' index 0 lc rgb "#0000ff" w lp title 'linear' ,\
     'index.dat' index 1 lc rgb "#00ff00" smooth bezier title 'exp'
</code></pre>
<p><code>data_name</code> で指定する方法</p>
<pre><code class="language-bash">plot 'index.dat' index 'linear' lc rgb "#0000ff" w lp title 'linear' ,\
     'index.dat' index 'exp' lc rgb "#00ff00" smooth bezier 'exp'
</code></pre>
<h3 id="data"><a class="header" href="#data">Data</a></h3>
<pre><code># linear
0 0
1 2
2 4
3 6
4 8
5 10


# exp
0 1
1 2
2 4
3 8
4 16
5 32
</code></pre>
<h3 id="result"><a class="header" href="#result">Result</a></h3>
<p><img src="https://i.imgur.com/8G9GXVI.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="データの段落分け-every"><a class="header" href="#データの段落分け-every">データの段落分け, every</a></h1>
<p>段落に分けることで異なるデータを一つのファイルに含めることができる.
段落は <strong>1</strong> つの空行で区切る.
段落は block と呼ばれる.
空行を除いた行を point (または column) と呼ぶ.</p>
<p><a href="datablock/index.html">index</a> もこれとよく似たが異なるデータフォーマットに対した操作を提供している.</p>
<h2 id="data-format-1"><a class="header" href="#data-format-1">Data Format</a></h2>
<pre><code class="language-dat"># data1
x1 y1
x2 y2
x3 y3

# data2
x1 y1
x2 y2
x3 y3
</code></pre>
<h2 id="every-keyword"><a class="header" href="#every-keyword"><code>every</code> keyword</a></h2>
<pre><code class="language-bash">plot ... every {&lt;point_incr&gt;}
    {:{&lt;block_inr&gt;}
    {:{&lt;start_point&gt;}
    {:{&lt;start_block&gt;}
    {:{&lt;end_point&gt;}
    {:{&lt;end_block&gt;}}}}}}
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>params</th><th>default</th><th>value</th><th>explanation</th></tr></thead><tbody>
<tr><td><code>point_incr</code></td><td>1</td><td>(int) index</td><td>読む point (行) のステップ</td></tr>
<tr><td><code>block_inr</code></td><td>1</td><td>(int) index</td><td>読む block のステップ</td></tr>
<tr><td><code>start_point</code></td><td>0</td><td>(int) index</td><td>読む point の最初 (0-indexed)</td></tr>
<tr><td><code>start_block</code></td><td>0</td><td>(int) index</td><td>読む block の最初 (0-indexed)</td></tr>
<tr><td><code>end_point</code></td><td>last</td><td>(string)</td><td>読む point の最後</td></tr>
<tr><td><code>end_block</code></td><td>last</td><td>(string)</td><td>読む block の最後</td></tr>
</tbody></table>
</div>
<p>例えば、 1 番目のブロック (0-start) のみ指定するには
<code>every :::1::1</code>
とする
(何度も言うがこれなら <code>index</code> の方が分かりやすいし良い).</p>
<h2 id="example-1"><a class="header" href="#example-1">Example</a></h2>
<h3 id="source-code-1"><a class="header" href="#source-code-1">Source Code</a></h3>
<pre><code class="language-bash">plot 'blocks.dat' every :::0::0 lc rgb "#0000ff" w lp title 'data1' ,\
     'blocks.dat' every :::1::1 lc rgb "#00ff00" smooth bezier title 'data2'
</code></pre>
<h3 id="data-blocksdat"><a class="header" href="#data-blocksdat">Data (blocks.dat)</a></h3>
<pre><code># linear
0 0
1 2
2 4
3 6
4 8
5 10

# exp
0 1
1 2
2 4
3 8
4 16
5 32
</code></pre>
<h3 id="result-1"><a class="header" href="#result-1">Result</a></h3>
<p><img src="https://i.imgur.com/FMLpzjT.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="データの入力"><a class="header" href="#データの入力">データの入力</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インラインデータ"><a class="header" href="#インラインデータ">インラインデータ</a></h1>
<p>スクリプトの中で直接データを書いて使う方法</p>
<h2 id="複数行文字列リテラルとして与える方法"><a class="header" href="#複数行文字列リテラルとして与える方法">複数行文字列リテラルとして与える方法</a></h2>
<p>変数にデータを代入してこれを plot させる.
以下の例では <code>$data</code> にデータを入れて使っている.</p>
<pre><code class="language-bash">$data &lt;&lt; EOD
0 0
1 1
2 4
3 8
4 16
5 24
6 32
EOD

plot $data w lp
</code></pre>
<h2 id="標準入力から与える方法"><a class="header" href="#標準入力から与える方法">標準入力から与える方法</a></h2>
<p>ファイル名を <code>'-'</code> とすると標準入力から読む.
標準入力といってもバッチ実行モードでは, plot コマンドに続くデータがそのまま標準入力として渡されるので, スクリプトにデータを記述できる.</p>
<p><code>e</code> コマンドでデータの入力を終わる.</p>
<pre><code class="language-bash">plot '-' w lp
0 0
1 1
2 4
3 8
4 16
5 24
6 32
e
</code></pre>
<p>複数 <code>'-'</code> をプロットすれば複数回データの入力を読む.</p>
<pre><code class="language-bash">plot '-' w lp, '-' w lp
1
2
3
e
1
4
9
e
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="シェルの実行"><a class="header" href="#シェルの実行">シェルの実行</a></h1>
<p><code>&lt;</code> から始まる文字列を plot の対象にすると, gnuplot はこれをシェルコマンドとして実行して, その標準出力を用いる.</p>
<h2 id="example-2"><a class="header" href="#example-2">Example</a></h2>
<h3 id="seq"><a class="header" href="#seq">seq</a></h3>
<p><code>seq 100</code> は 1 から 100 までの整数を 100 行で出力する.
これをデータと思えば次のような事ができる.</p>
<pre><code class="language-bash">plot '&lt;seq 100' ,\
     '&lt;seq 100' u 1:($1*sin($1/pi)) smooth bezier
</code></pre>
<h3 id="データのフィルタ"><a class="header" href="#データのフィルタ">データのフィルタ</a></h3>
<p>次のようなテキストファイル (<code>data.txt</code>) があるとする.</p>
<pre><code>A 3
B 10
A 4
B 11
A 5
B 12
</code></pre>
<p>このときに <code>A</code> のある行だけのプロット, <code>B</code> の行のプロットを行うには, <code>grep</code> によるフィルタを利用すればよい.</p>
<pre><code class="language-bash">plot '&lt; grep A data.txt' title 'A' ,\
     '&lt; grep B data.txt' title 'B'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="日付時刻データ"><a class="header" href="#日付時刻データ">日付時刻データ</a></h1>
<p>よくあるシチュエーションは x 軸または y 軸のどちらか一方が日付時刻を表現していることだ. このとき, データには一種類のフォーマットで日付時刻が書かれていることになる. gnuplot はこれをサポートしていて, x/y 軸が日付時刻を表していることと, パースに用いるフォーマットを指定すれば読むことが出来る.</p>
<p>本章の最後でも触れるが, 異なるデータフォーマットが混在している場合, 例えば x/y 軸両方ともが日付時刻であってそれぞれ違う書き方がなされている場合は, 出来なくはないが, 直接のサポートがなされてはいない.</p>
<h2 id="日付時刻であることの宣言"><a class="header" href="#日付時刻であることの宣言">日付時刻であることの宣言</a></h2>
<p>x/y 軸それぞれについて日付時刻データであることは次で宣言する.</p>
<pre><code class="language-bash">set xdata time
set ydata time
</code></pre>
<h2 id="timefmt"><a class="header" href="#timefmt">timefmt</a></h2>
<p>日付時刻データだと宣言された値はデフォルトでは
<code>"%d/%m/%y,%H:%M"</code>
だとしてパースが行われる.
このフォーマットは,</p>
<pre><code class="language-bash">set timefmt &lt;format&gt;
</code></pre>
<p>として自由に宣言できる.</p>
<p>また <code>xtics</code> <code>ytics</code> の表示に使うフォーマットは, これとは別に宣言できて, 次のようにする.</p>
<pre><code class="language-bash">set format x &lt;format&gt;
set format y &lt;format&gt;
</code></pre>
<p>この <code>&lt;format&gt;</code> は先程の <code>timefmt</code> で使う <code>&lt;format&gt;</code> と全く同じ形式で記述する.
フォーマットは C 言語のように <code>%-</code> 指定子を含んだ文字列として指定する.</p>
<h3 id="-指定子"><a class="header" href="#-指定子"><code>%-</code>指定子</a></h3>
<div class="table-wrapper"><table><thead><tr><th>format</th><th>explanation</th></tr></thead><tbody>
<tr><td><code>%d</code></td><td>日 (1-31)</td></tr>
<tr><td><code>%m</code></td><td>月 (1-12)</td></tr>
<tr><td><code>%y</code></td><td>年の下2桁 (0-99)</td></tr>
<tr><td><code>%Y</code></td><td>年の4桁</td></tr>
<tr><td><code>%j</code></td><td>day of the year (1-365)</td></tr>
<tr><td><code>%H</code></td><td>時 (0-24)</td></tr>
<tr><td><code>%M</code></td><td>分 (0-60)</td></tr>
<tr><td><code>%S</code></td><td>秒 (0-60)</td></tr>
<tr><td><code>%s</code></td><td>UNIX time</td></tr>
<tr><td><code>%B</code></td><td>月の英語表記</td></tr>
<tr><td><code>%b</code></td><td>月の英語表記 (3文字省略形)</td></tr>
</tbody></table>
</div>
<h3 id="note-using-キーワード"><a class="header" href="#note-using-キーワード">NOTE. <code>using</code> キーワード</a></h3>
<p>gnuplot は plot するデータを読むとき, 一行をホワイトスペース文字で分割して, これの何番目を x データ, 何番目を y データという風に使っている.
ここで疑問になるのは, 空白文字を含む日付時刻データを表現できるのかということだ.
問題なく出来る.
<code>timefmt</code> には空白文字を含んだフォーマットを指定すればよい.
ただし, plot コマンドは <code>using</code> を要請してくるかもしれない.
これは明示的に何番目と何番目を x, y データにするかという指定である.</p>
<p>次のようなデータを考える.</p>
<pre><code>2020-01-02 13:00 3.141592
</code></pre>
<p>これは
<code>'%Y-%m-%d %H:%M'</code>
というフォーマットの日付の後ろに一つの数値が続いている.
gnuplot はこのままでは3つの数値が並んでいると解釈する.</p>
<p>そこで初めの二つが x のための一塊の日付データであることを宣言する.</p>
<pre><code class="language-bash">set xdata time
set timefmt '%Y-%m-%d %H:%M'
</code></pre>
<p>こうなるともともと二番目が y であるというデフォルトの設定が壊れるので,
gnuplot はユーザーに明示することを求める.
そこで, （もともとの分割で）1 番目が x で, 3 番目が y であると注釈して plot を行う.</p>
<pre><code class="language-bash">plot 'data.txt' using 1:3
</code></pre>
<p>これで期待通りのプロットが得られた.</p>
<h2 id="異なるフォーマットを共存させるには"><a class="header" href="#異なるフォーマットを共存させるには">異なるフォーマットを共存させるには</a></h2>
<p>x と y が異なるフォーマットの日付時刻データである,
或いは複数のデータを同時にプロットさせるに当たって別のフォーマットが使われてるなどの場合,
異なるフォーマットを指定したくなる.
しかし <code>set timefmt</code> は設定を上書きするだけであって, x と y のパースに異なるフォーマットを与える事はできない.</p>
<p>やや強引にやってやれないことはない.
<a href="https://stackoverflow.com/a/31009235">https://stackoverflow.com/a/31009235</a>
が参考になった.
<code>using</code> の中で <code>strptime</code> 関数を直接呼び出せばよい.
<code>gnuplot 5.0</code> 以上ならより簡素な <code>timecolumn</code> 関数の方が便利</p>
<h3 id="example-3"><a class="header" href="#example-3">Example</a></h3>
<p><code>timecolumn</code> 関数を使って, x, y で別のフォーマットが使われているデータをプロットする.</p>
<pre><code class="language-bash"># x = %Y-%m-%d
# y = %H:%M:%S
$data &lt;&lt; EOD
2017-10-23 13:43:00
2017-10-24 14:37:45
2017-10-25 14:18:06
2017-10-26 14:31:48
2017-10-27 12:12:41
2017-10-30 13:56:49
EOD

set xdata time
set ydata time

xformat = '%Y-%m-%d'  # parse format (for timecolumn)
yformat = '%H:%M:%S'

set format x '%m/%d'  # tics format
set format y '%H:%M'

plot $data using (timecolumn(1, xformat)):(timecolumn(2, yformat)) w lp
</code></pre>
<p><img src="https://i.imgur.com/2HtaPTU.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="装飾"><a class="header" href="#装飾">装飾</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xtics"><a class="header" href="#xtics">xtics</a></h1>
<p>ytics も全く同様</p>
<h2 id="reference-1"><a class="header" href="#reference-1">Reference</a></h2>
<ul>
<li><a href="http://gnuplot.sourceforge.net/docs_4.2/node295.html">Xtics - docs_4.2</a></li>
</ul>
<h2 id="刻み幅の指定"><a class="header" href="#刻み幅の指定">刻み幅の指定</a></h2>
<p>目盛りの刻み幅を指定する.</p>
<pre><code class="language-bash">set xtics 5
</code></pre>
<p><img src="https://i.imgur.com/wR7BauF.png" alt="" /></p>
<h2 id="目盛りラベルの回転"><a class="header" href="#目盛りラベルの回転">目盛りラベルの回転</a></h2>
<pre><code class="language-bash">set xtics rotate by 30 right
</code></pre>
<p>角度 (deg) とどこを中心に回転するかの指定.
角度は反時計回りで, 負数で時計回りに回せる.
<code>right</code> キーワードでラベルの右端を中心に回転することを指定する.
省略すると左端を中心に回転する.</p>
<h3 id="example-4"><a class="header" href="#example-4">Example</a></h3>
<pre><code class="language-bash">set xtics rotate by 30 right
set xrange [-100:100]
plot x title "rotate by 30 right"
</code></pre>
<p><img src="https://i.imgur.com/GPLvsY5.png" alt="" /></p>
<h2 id="ラベル文字列の指定"><a class="header" href="#ラベル文字列の指定">ラベル文字列の指定</a></h2>
<p>ラベル文字列と座標の組のリストを与えることで, 数字付きの tics じゃなくてラベル文字列を指定した座標に置く事ができる.</p>
<pre><code class="language-bash">set xtics ("label1" x1, "label2" x2, "label3" x3)
</code></pre>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<pre><code class="language-gnuplot">set xrange [0:6]
set xtics ("zero" 0, "two" 2, "last" 6)
set grid
plot x
</code></pre>
<p><img src="https://i.imgur.com/5oatvRz.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="点の周りにスペースを空ける-pointinterval"><a class="header" href="#点の周りにスペースを空ける-pointinterval">点の周りにスペースを空ける, pointinterval</a></h1>
<h2 id="概要"><a class="header" href="#概要">概要</a></h2>
<p><code>with linespoints</code> のときに点を線でつないで描画されるがそのとき点の周りに少しスペースを空ける事ができる.
これを実現するには,
<code>pointinterval (pi)</code> で <code>-1</code> を指定して, <code>set pointintervalbox</code> でスペースの大きさを指定すると実現できる.</p>
<h2 id="example-6"><a class="header" href="#example-6">Example</a></h2>
<pre><code class="language-bash">set style line 1 pi -1
set style line 1 pt 6  # 点を丸にする
set pointintervalbox 3  # 点と線をあける距離

$data &lt;&lt; EOD
1
3
5
6
7
EOD
plot $data w lp ls 1
</code></pre>
<p><img src="https://i.imgur.com/Pjq3VYe.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="awesome-style"><a class="header" href="#awesome-style">awesome style</a></h1>
<pre><code class="language-bash">set terminal pngcairo

set style line 1 lw 2 pt 6 lc rgb "#00aaaa"

set style line 11 lc rgb '#808080' lt 1 lw 3
set border 0 back ls 11
set tics out nomirror

set style line 12 lc rgb '#808080' lt 0 lw 1
set grid back ls 12

set xrange [-4:4]
plot x**3 linestyle 1
</code></pre>
<p><img src="https://i.imgur.com/q5HVo7E.png" alt="result" /></p>
<p>gnuplot はそのまま使うと一見して gnuplot で作ったダサい見た目になりがち.
小洒落たスタイルでライバルに差をつけろ.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="曲線の近似-fit"><a class="header" href="#曲線の近似-fit">曲線の近似, fit</a></h1>
<h1 id="fit"><a class="header" href="#fit">fit</a></h1>
<p>fit コマンドを使うとデータ点列を説明 (近似) するような曲線を探索できる.</p>
<h2 id="synopsis"><a class="header" href="#synopsis">SYNOPSIS</a></h2>
<pre><code class="language-bash">f(x) = g(x, a, b, c)
fit [:][:] f(x) 'data' via a, b, c
</code></pre>
<h2 id="例"><a class="header" href="#例">例</a></h2>
<p>ノイジーな正弦曲線を描く Ruby スクリプトをデータの例に使う.</p>
<pre><code class="language-ruby"># data.rb
def noisy_sin(x)
  return Math.sin(x) + (rand - 0.5) * 0.2
end

100.times do |i|
  x = (i - 50) / 20.0
  puts "#{x} #{noisy_sin x}"
end
</code></pre>
<p>ランダムなので実行のたびに結果が変わるけど, そこは目をつむってもらって
gnuplot からは <code>&lt;ruby data.rb</code> を参照する.</p>
<p>fit コマンドを使うには, このデータを近似する関数を定義する.
ただし関数の定義には自由な変数を使って良い.
例えば下の例では
\( f(x) = ax^3+bx+c \)
という関数を定義し,
係数に \( a,b,c \) という自由変数を含んでいる.</p>
<p>係数には適用な値を代入して初期化しておく.
初期化されてない場合は <code>1</code> が自動的に使われるが,
ある程度当たりをつけて良い初期値を入れることは結果の精度の為に大事になってくることがある.</p>
<pre><code class="language-bash">f(x) = a * x**3 + b * x + c
a = 1
b = -2
c = 0
</code></pre>
<p>この <code>f(x)</code> を使って fit コマンドを次のように叩く.
<code>via</code> キーワードの次に探索して欲しい変数を列挙する.</p>
<pre><code class="language-bash">fit f(x) '&lt; ruby data.rb' via a, b, c
plot '&lt; ruby data.rb', f(x)
</code></pre>
<p>fit コマンドが終了した時点で, <code>a, b, c</code> には fitting し終えた値が代入されているので,
そのまま <code>plot f(x)</code> をすれば, 結果の曲線を描かせることができる.
今回は次のような結果が得られた.</p>
<p><img src="https://i.imgur.com/GsL5nx8.png" alt="" /></p>
<p><code>f(x)</code> は多項式である必要はない.
例えばデータが正弦波っぽく見えたのなら直接正弦波に近似させればよい.</p>
<pre><code class="language-bash">f(x) = a * sin(b * x + c)
a = 0
b = 0
c = 0
fit f(x) '&lt; ruby data.rb' via a, b, c
plot '&lt; ruby data.rb', f(x)
</code></pre>
<p>おそらく <code>a=1, b=1, c=0</code> に近い値がセットされるはず.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="プロット"><a class="header" href="#プロット">プロット</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="散布図"><a class="header" href="#散布図">散布図</a></h1>
<h2 id="data-1"><a class="header" href="#data-1">Data</a></h2>
<p>一点を一行に x, y 座標を並べて記述する.</p>
<pre><code>x1 y1
x2 y2
x3 y3
</code></pre>
<h2 id="source-code-2"><a class="header" href="#source-code-2">Source Code</a></h2>
<p>オプションなしに <code>plot</code> コマンドを使うと散布図がプロットされる.</p>
<pre><code class="language-bash">$data &lt;&lt; EOD
0 0
0 1
1 1
1 2
2 2
EOD

set xrange [-1:3]
set yrange [-1:3]
plot $data pointtype 6
</code></pre>
<h2 id="result-2"><a class="header" href="#result-2">Result</a></h2>
<p><img src="https://i.imgur.com/y96sW7e.png" alt="" /></p>
<h2 id="テキストラベルの散布図"><a class="header" href="#テキストラベルの散布図">テキスト（ラベル）の散布図</a></h2>
<p>ただの点の代わりにテキスト（ラベル）を用いた散布図を作るには
<code>with labels</code> を用いる.</p>
<pre><code class="language-bash">$data &lt;&lt; EOD
0 0 A
0 1 B
1 1 C
1 2 D
2 2 E
EOD

set xrange [-1:3]
set yrange [-1:3]
plot $data with labels
</code></pre>
<p>データの3つ目がデフォルトではラベルとして使われる.</p>
<p><img src="https://i.imgur.com/DhM6iXw.png" alt="" /></p>
<pre><code class="language-bash">plot $data with labels boxed
</code></pre>
<p><img src="https://i.imgur.com/abJY2Gp.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ヒストグラム度数表"><a class="header" href="#ヒストグラム度数表">ヒストグラム（度数表）</a></h1>
<h2 id="概要-1"><a class="header" href="#概要-1">概要</a></h2>
<p>ある値の列からなるデータがあるとき, コレに関するヒストグラムを作成する.
直接的にその機能は gnuplot にはなく,
度数を計算する必要があるが, 次の方法を使うとうまくこれが gnuplot の機能で実現する.</p>
<h2 id="手法"><a class="header" href="#手法">手法</a></h2>
<p><code>x:(1.0)</code> からなる折れ線グラフを
<code>with frequency</code>
で描くと重複した点の個数だけ <code>y</code> を加算する.
これに <code>with boxes</code> 等の装飾を施すことでよくあるヒストグラムを描ける.</p>
<h2 id="example-7"><a class="header" href="#example-7">Example</a></h2>
<p>データはソートしておいた方が無難.
<code>x</code> の上に置く box は <code>x</code> を中心とする幅を持った箱として描画されるので,
必要に応じて <code>0.5</code> だけずらすなどすると見やすくなる.</p>
<p><img src="https://i.imgur.com/jlBaaED.png" alt="" /></p>
<h3 id="source-code-3"><a class="header" href="#source-code-3">Source Code</a></h3>
<pre><code class="language-bash">width = 1.0
hist(x) = width * (floor(x / width) + 0.5)
set boxwidth width * 1.0
set xtics width

$data &lt;&lt;EOM
0
1
1
1
1
2
2
3
6
8
EOM

set xrange [0:10]
set yrange [0:]
set ytics 1
set grid
set style fill solid 0.5 border lc rgb '#55aaff'
plot $data u (hist($1)):(1) smooth frequency with boxes fillcolor '#55aaff' not
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="箱ひげ図-boxplot-box-and-whisker-plot"><a class="header" href="#箱ひげ図-boxplot-box-and-whisker-plot">箱ひげ図 (boxplot, box-and-whisker plot)</a></h1>
<h2 id="参考"><a class="header" href="#参考">参考</a></h2>
<ul>
<li><a href="http://gnuplot.info/demo/boxplot.html">http://gnuplot.info/demo/boxplot.html</a></li>
<li><a href="https://ja.wikipedia.org/wiki/%E7%AE%B1%E3%81%B2%E3%81%92%E5%9B%B3">箱ひげ図 - Wikipedia</a></li>
</ul>
<h2 id="概要-2"><a class="header" href="#概要-2">概要</a></h2>
<p>\(\{ (\text{label}_i, z_i) \}_i\)
\( (z_i \in \mathbb{R}) \) というデータ列から,
次の図のような, いわゆる箱ひげ図を作成する.</p>
<p><img src="https://i.imgur.com/3YPqnHs.png" alt="" /></p>
<h2 id="手法-1"><a class="header" href="#手法-1">手法</a></h2>
<p><code>with boxplot</code> によって直接サポートされている.</p>
<h2 id="data-format-2"><a class="header" href="#data-format-2">Data Format</a></h2>
<p>一列目にデータのラベル (またはカテゴリ) を文字列で与える.
これに関してソートする必要はない.
二列目にデータの実数値を与える.</p>
<pre><code>Label_1 z1
Label_2 z2
:
Label_n zn
</code></pre>
<h2 id="with-boxplot"><a class="header" href="#with-boxplot"><code>with boxplot</code></a></h2>
<pre><code class="language-bash">plot ... using &lt;x&gt;:&lt;z&gt;{:&lt;box_width&gt;{:&lt;label&gt;}} with boxplot
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>params</th><th>default</th><th>value</th><th>explanation</th></tr></thead><tbody>
<tr><td><code>x</code></td><td>--</td><td>(double)x</td><td>データ (箱ひげ) を置く x 座標</td></tr>
<tr><td><code>z</code></td><td>--</td><td>(double)z</td><td>データ (実数値)</td></tr>
<tr><td><code>box_width</code></td><td>--</td><td>(double)</td><td>箱の横幅サイズ</td></tr>
<tr><td><code>label</code></td><td>--</td><td>(string)</td><td>データのラベル. これを与えるとき <code>x</code> は無視される</td></tr>
</tbody></table>
</div>
<p>ラベルを与える時 <code>x</code> は無視されるが何か与える必要があるので, 仮にゼロを与えておく.</p>
<p>先述のデータに合わせると次のようにすればよい.</p>
<pre><code class="language-bash">using (0):2:(1):1 with boxplot
</code></pre>
<h2 id="example-8"><a class="header" href="#example-8">Example</a></h2>
<h3 id="data-datatxt"><a class="header" href="#data-datatxt">Data (data.txt)</a></h3>
<details><pre><code>
Label1 1.0615736091746653
Label1 0.9409952532221867
Label1 1.021612466595744
Label1 0.8935688060271614
Label1 1.0224404474617517
Label1 0.9661892724606262
Label1 0.9978595814447482
Label1 1.1127551356245484
Label1 1.1016617034534295
Label1 0.9210394458787583
Label1 1.0820741675354117
Label1 1.04330023111802
Label1 1.0005150566113892
Label1 1.1559580109911893
Label1 1.1233029737728761
Label1 0.9474749102980315
Label1 1.0707941673561174
Label1 0.9269711019325906
Label1 0.9582840543918602
Label1 1.0341070340590386
Label1 0.9719420637089871
Label1 1.0380944985473386
Label1 0.9696442248316298
Label1 0.9032356007739286
Label1 0.9475300145319969
Label1 1.1176373421060464
Label1 1.1027176241074508
Label1 0.933838661044742
Label1 0.9320799966742921
Label1 0.9881518086130608
Label1 0.9452352866888151
Label1 0.9855244566192534
Label1 1.1529506550742137
Label1 0.9655108140953337
Label1 1.1077149125236252
Label1 0.9545337303266723
Label1 0.9864761998749835
Label1 0.9992270973259703
Label1 1.0003472317982158
Label1 0.9669086586777813
Label1 1.0106215356365427
Label1 1.0694842820371275
Label1 1.048621359612009
Label1 0.9571141696805319
Label1 1.033258266154869
Label1 1.1092157291217004
Label1 0.9772753273440217
Label1 1.0516819827815074
Label1 0.9930686178999505
Label1 0.9695499340325655
Label1 1.058463723596836
Label1 1.0646466807321475
Label1 1.039382795500945
Label1 0.8016797870382525
Label1 0.9551423217491737
Label1 1.005006229693936
Label1 1.0298153359978677
Label1 0.9745127192018938
Label1 1.06121120938568
Label1 1.0172213952705071
Label1 0.8577883940535215
Label1 1.0730787104344803
Label1 0.9353661239234157
Label1 0.8878019375801003
Label1 0.9200416472254476
Label1 1.10202551417308
Label1 0.9953501566212274
Label1 0.9765505280492441
Label1 0.9934534876777504
Label1 0.9279105001877123
Label1 0.9311577450839491
Label1 1.0382565034812055
Label1 1.0807674382580108
Label1 1.1058527324445429
Label1 0.9536624649476464
Label1 1.090047310657586
Label1 1.0342275655050817
Label1 0.9010216243779239
Label1 0.9849931815493391
Label1 0.9455332189802604
Label1 0.9366573719398363
Label1 0.9792632919138815
Label1 1.0673954929564329
Label1 1.0788127015434597
Label1 1.0401365015326332
Label1 1.0149435226488914
Label1 1.1044694815360434
Label1 1.0710494392439736
Label1 1.029971424957326
Label1 0.907396727162235
Label1 0.9368299278735874
Label1 0.9375642076839391
Label1 0.9230619994657261
Label1 1.034461417462147
Label1 0.9593967932528256
Label1 0.9719254811281577
Label1 1.0387483102509225
Label1 0.9645077135736616
Label1 0.9673363635776973
Label1 1.083377921829951
Label2 1.1140536481728907
Label2 0.9654311468502879
Label2 1.0072034351318897
Label2 0.7645604617492925
Label2 0.8392703482428308
Label2 0.976250057889414
Label2 0.5990641184705816
Label2 0.8380012721558732
Label2 1.0035631655139747
Label2 1.1808497231287727
Label2 0.8564673010352255
Label2 0.9745542687000399
Label2 0.8808016171091044
Label2 0.8657582290481092
Label2 1.01875121639354
Label2 0.9488799185405365
Label2 0.9700677235401467
Label2 1.1620803369440535
Label2 1.0900652181216892
Label2 1.2796516746441746
Label2 0.6920004621992418
Label2 1.18769693522479
Label2 0.8401843624543999
Label2 0.999731755629597
Label2 1.0379869812764944
Label2 1.169339327212957
Label2 1.1065612897474275
Label2 0.9318951992749085
Label2 0.9075922105985541
Label2 0.9643943402394666
Label2 1.103034508986277
Label2 1.343461136243981
Label2 0.6019797237657606
Label2 0.7439376596771563
Label2 0.8444287387561433
Label2 1.3020239636373763
Label2 0.7333487819632483
Label2 1.1025954377572993
Label2 0.7448648734731773
Label2 0.9186726148655824
Label2 1.2736324607754193
Label2 0.738547568433712
Label2 0.8997911309025082
Label2 0.8183666890944847
Label2 1.2305161819556596
Label2 0.8431803874807591
Label2 1.0421608735310546
Label2 0.8703113248033603
Label2 0.985872237356056
Label2 1.0702074132990238
Label2 0.736884590985943
Label2 1.204378967522794
Label2 1.0559821939077376
Label2 1.2243650688093677
Label2 0.8770786400785613
Label2 0.9431412119605815
Label2 1.1587470690948034
Label2 1.0820150639003154
Label2 1.068216370162204
Label2 1.0862971817469724
Label2 1.0602079089156522
Label2 0.9741626353656363
Label2 0.8514434676459397
Label2 1.0422702760367746
Label2 0.8342329643622799
Label2 1.04598974412835
Label2 1.118337840796598
Label2 1.1541095322445498
Label2 1.0671985326270028
Label2 0.9921031013544135
Label2 0.7991098543565645
Label2 0.8025079639486893
Label2 0.7873720427596531
Label2 1.17644344114844
Label2 0.9017761717860211
Label2 1.2325537126446182
Label2 1.3790767902319523
Label2 0.834204048131308
Label2 1.19896383864128
Label2 1.284211366903643
Label2 1.0026063764611894
Label2 0.8227679581718057
Label2 1.307136977957998
Label2 1.0444638948513583
Label2 1.3549943740829442
Label2 1.0844549039775195
Label2 1.317654569043726
Label2 1.1063868777177488
Label2 0.6493872700423977
Label2 1.3594778312593627
Label2 1.338062365553617
Label2 1.0238162018568993
Label2 0.9763703711732645
Label2 1.1206954992017968
Label2 1.1707303801478295
Label2 1.1098209988634946
Label2 1.0227536289855048
Label2 0.8128615195559445
Label2 0.9673353252194339
Label2 1.2047888354760614
Label3 0.5142551015781237
Label3 0.4543057623585313
Label3 0.4531749926703077
Label3 0.48366076176550665
Label3 0.4882834640187006
Label3 0.4580007777054271
Label3 0.4511591973406706
Label3 0.4895097408191484
Label3 0.5329419883612687
Label3 0.5073465220061663
Label3 0.553665903126604
Label3 0.5125565716535394
Label3 0.5064784727203651
Label3 0.4915476117281144
Label3 0.5199793237483948
Label3 0.5533038298565817
Label3 0.4596452171947456
Label3 0.49234192751323397
Label3 0.45981983116631875
Label3 0.46678102685181655
Label3 0.4675946531066316
Label3 0.4791166260360197
Label3 0.5339293985406127
Label3 0.5044951008880407
Label3 0.468439539866198
Label3 0.5412932409671252
Label3 0.5050151849881355
Label3 0.457661329345758
Label3 0.4801070293435854
Label3 0.4895079651566656
Label3 0.5307725497729896
Label3 0.4770394661958832
Label3 0.5458251641478383
Label3 0.48719290103259233
Label3 0.493902831741011
Label3 0.4684886716663316
Label3 0.5106616471106656
Label3 0.43985179427762006
Label3 0.5100289180635535
Label3 0.49105881770638904
Label3 0.5006929938151032
Label3 0.4205157631344141
Label3 0.4896354045961837
Label3 0.5214170188862951
Label3 0.4954576988782891
Label3 0.5128906445762597
Label3 0.4893522622337194
Label3 0.5348450354119353
Label3 0.540807960920562
Label3 0.4783686743022514
Label3 0.5354571299421252
Label3 0.41804886150008075
Label3 0.5008395090647499
Label3 0.520352926239639
Label3 0.46931543637664036
Label3 0.4829886328506878
Label3 0.5328436338152367
Label3 0.5010186015477949
Label3 0.46172801207972547
Label3 0.49344169414465205
Label3 0.47975646724709775
Label3 0.47860712998302263
Label3 0.47940533521467144
Label3 0.5064141556425302
Label3 0.5435954464135971
Label3 0.4726682971819423
Label3 0.4915653483459668
Label3 0.5429375594647708
Label3 0.5146961771791269
Label3 0.4602116215820299
Label3 0.48364222133902723
Label3 0.4880924356997455
Label3 0.463293654288834
Label3 0.5290598992663654
Label3 0.5053241702600492
Label3 0.49873576395994607
Label3 0.4856733190958129
Label3 0.5095764551389661
Label3 0.46860168864284146
Label3 0.47401577020214813
Label3 0.4769570659881741
Label3 0.4675472572820617
Label3 0.43982243691092143
Label3 0.4785556880114518
Label3 0.48797910910782355
Label3 0.5352870207701941
Label3 0.5448180495250096
Label3 0.48879005713593154
Label3 0.5100877092012684
Label3 0.5184395026828384
Label3 0.5121601200254514
Label3 0.47587957491496463
Label3 0.5055463257181718
Label3 0.5127501923045343
Label3 0.4758265536759175
Label3 0.46611694850111995
Label3 0.4785810300794278
Label3 0.508939248784815
Label3 0.5101959427210576
Label3 0.5100732410148193
Label1 0.16537364208595623
Label1 0.6776651320647064
Label1 0.5939587550913237
Label1 0.5188986682173724
</code></pre></details>
<h3 id="source-code-4"><a class="header" href="#source-code-4">Source Code</a></h3>
<pre><code class="language-bash">set grid
set ytics 0.1
unset key
plot 'data.txt' using (0):2:(0):1 with boxplot
</code></pre>
<h3 id="result-3"><a class="header" href="#result-3">Result</a></h3>
<p><img src="https://i.imgur.com/3YPqnHs.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="エラーバー-誤差付きプロット-yerrorbars"><a class="header" href="#エラーバー-誤差付きプロット-yerrorbars">エラーバー, 誤差付きプロット, yerrorbars</a></h1>
<h2 id="参考-1"><a class="header" href="#参考-1">参考</a></h2>
<ul>
<li><a href="http://dsl4.eee.u-ryukyu.ac.jp/DOCS/gnuplot/node158.html">http://dsl4.eee.u-ryukyu.ac.jp/DOCS/gnuplot/node158.html</a></li>
</ul>
<h2 id="概要-3"><a class="header" href="#概要-3">概要</a></h2>
<p>y軸方向にエラーバーについたプロットを行う.
エラーの大きさ（半径）を指定する方法と, 上限と下限のそれぞれを指定する方法の二つがある.</p>
<h2 id="with-yerrorbars"><a class="header" href="#with-yerrorbars"><code>with yerrorbars</code></a></h2>
<p>次のいずれか.</p>
<pre><code class="language-bash">plot ... using {&lt;x&gt;:}&lt;y&gt;:&lt;ydelta&gt; with yerrorbars
plot ... using &lt;x&gt;:&lt;y&gt;:&lt;ylow&gt;:&lt;yhigh&gt; with yerrorbars
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>params</th><th>default</th><th>value</th><th>explanation</th></tr></thead><tbody>
<tr><td><code>x</code></td><td>--</td><td>(double) x</td><td>x 座標</td></tr>
<tr><td><code>y</code></td><td>--</td><td>(double) y</td><td>エラーバーの中点 y 座標</td></tr>
<tr><td><code>ydelta</code></td><td>--</td><td>(double)</td><td>これのプラスマイナスを <code>ylow</code> <code>yhigh</code> とする</td></tr>
<tr><td><code>ylow</code></td><td>--</td><td>(double)</td><td>エラーバーの下点 y 座標</td></tr>
<tr><td><code>yhigh</code></td><td>--</td><td>(double)</td><td>エラーバーの上点 y 座標</td></tr>
</tbody></table>
</div>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="ydelta"><a class="header" href="#ydelta">ydelta</a></h3>
<p>ydelta \( \Delta \) を指定する場合は \( y \pm \Delta \) をエラー範囲とする.</p>
<pre><code class="language-bash">$data &lt;&lt; EOM
-5 -10 2.5
-4 -8 1.6
-3 -6 0.9
-2 -4 0.4
-1 -2 0.1
0 0 0.0
1 2 0.1
2 4 0.4
3 6 0.9
4 8 1.6
EOM

set grid
plot $data u 1:2:3 with yerrorbars
</code></pre>
<p><img src="https://i.imgur.com/3S0qvEb.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="陰関数"><a class="header" href="#陰関数">陰関数</a></h1>
<p>xy 座標上の関数
\[ f(x,y) = 0 \]
で表現されるグラフのプロットを考える.</p>
<h2 id="手法-2"><a class="header" href="#手法-2">手法</a></h2>
<p>三次元グラフとして描画する.
これを \(z=0\) 平面で切り取ると目的のグラフが得られる.</p>
<h2 id="example-9"><a class="header" href="#example-9">Example</a></h2>
<p>\(x^2 + xy + y^2 = 1\) を描画する.
定数を移項することで \(f(x,y)=0\) の形にする.</p>
<pre><code class="language-bash">set view 0,0
unset surface
set isosamples 100,100
set contour
set cntrparam levels discrete 0
set xrange [-2:2]
set yrange [-2:2]

f(x, y) = x * x + x * y + y * y - 1
splot f(x, y)
</code></pre>
<p><img src="https://i.imgur.com/1Wiw7SA.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="等高線"><a class="header" href="#等高線">等高線</a></h1>
<h2 id="方法"><a class="header" href="#方法">方法</a></h2>
<pre><code class="language-bash">set contour
unset surface
set view 0, 0

set isosamples 100
set cntrparam levels 9

set key out

splot x**2 - y**2
</code></pre>
<p><img src="https://i.imgur.com/Quhsylf.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ヒートマップ-混合行列"><a class="header" href="#ヒートマップ-混合行列">ヒートマップ, 混合行列</a></h1>
<h2 id="参考-2"><a class="header" href="#参考-2">参考</a></h2>
<ul>
<li><a href="http://gnuplot.sourceforge.net/demo_svg/heatmaps.html">gnuplot demo script: heatmaps.dem</a></li>
</ul>
<h2 id="概要-4"><a class="header" href="#概要-4">概要</a></h2>
<p>混合行列 (Confusion Matrix) などと呼ばれるあの表を色付きで図示する.
色の濃さで数の大きさを表現する.</p>
<p>上の参考リンクでは色が連続して変化するように中間値補完が為されてるが,
私の知ってるgnuplotのバージョンではこれは再現できない.
これをするには <code>pm3d</code> を使ったほうがいいと思う.</p>
<p><img src="https://i.imgur.com/8FJ6kh9.png" alt="" /></p>
<h2 id="方法-1"><a class="header" href="#方法-1">方法</a></h2>
<h3 id="data-format-3"><a class="header" href="#data-format-3">Data Format</a></h3>
<p>行列 (<code>matrix</code>) 形式でデータを与えることにする.
すなわち, データ $z$ を $n$ 行 $m$ 列に並べたものをデータとする.</p>
<pre><code class="language-dat">z11 z12 z13
z21 z22 z23
z31 z32 z33
z41 z42 z43
</code></pre>
<p>混合行列を図示する目的のためには行と列とに見出し (座標ではなくラベル) があるべきで,
どうせならデータに含めたい.
gnuplot の matrix data は行ごとのアイテム数は揃ってる必要があるので,
0行目0列目にはダミーデータを入れた上で,
1行目または1列目に見出しを入れられる.</p>
<pre><code class="language-dat">xxxx Col1 Col2 Col3
Row1  z11  z12  z13
Row2  z21  z22  z23
Row3  z31  z32  z33
Row4  z41  z42  z43
</code></pre>
<h3 id="with-image"><a class="header" href="#with-image"><code>with image</code></a></h3>
<pre><code class="language-bash">plot ... using &lt;x&gt;:&lt;y&gt;:&lt;z&gt; with image
</code></pre>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">params</th><th style="text-align: center">default</th><th style="text-align: left">value</th><th style="text-align: left">explanation</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>x</code></td><td style="text-align: center">--</td><td style="text-align: left">(int)</td><td style="text-align: left">データの $x$ 座標</td></tr>
<tr><td style="text-align: left"><code>y</code></td><td style="text-align: center">--</td><td style="text-align: left">(int)</td><td style="text-align: left">データの $y$ 座標</td></tr>
<tr><td style="text-align: left"><code>z</code></td><td style="text-align: center">--</td><td style="text-align: left">(double)</td><td style="text-align: left">データ. 対応する色が塗られる</td></tr>
</tbody></table>
</div>
<p>ただし, matrix で読む場合は <code>x</code>, <code>y</code> は自動的に column 1, 2 として適切な値が入ってると見なしてよい.</p>
<h3 id="columnheaders-rowheaders"><a class="header" href="#columnheaders-rowheaders"><code>columnheaders</code>, <code>rowheaders</code></a></h3>
<pre><code class="language-bash">plot ... matrix column rowheaders
</code></pre>
<p>データの一行目, 一列目の文字列を見出しだと思って,
二行目, 二列目以降のデータだけを使う.</p>
<h3 id="example-10"><a class="header" href="#example-10">Example</a></h3>
<pre><code class="language-bash">$data &lt;&lt; EOM
xxxx Col1 Col2 Col3
Row1    1    2    3
Row2    2    4    6
Row3    4    8   12
Row4    8   16   24
EOM

unset key
set title 'Heatmap with image'

set cbrange [0:30]  # the range of colorbox
set palette cubehelix start -2 cycles 0 saturation 3 gamma 3 negative  # color scheme

plot $data matrix rowheaders columnheaders u 1:2:3 with image ,\
        '' matrix rowheaders columnheaders u 1:2:(sprintf("%g", $3)) with labels
</code></pre>
<p><img src="https://i.imgur.com/L1QEXwC.png" alt="" /></p>
<h2 id="格子線-gridline"><a class="header" href="#格子線-gridline">格子線 (gridline)</a></h2>
<p><code>set grid</code> によってセル同士の境界に線を引きたい.
デフォルトだとセルの色塗りは gridline の後に行われて上書きされるので <code>set grid front</code> とする.
<code>lt</code> や <code>lc</code>, <code>lw</code> で線のスタイルは調整する.</p>
<pre><code class="language-bash">$data &lt;&lt; EOD
X a b c d e
A 0.0 -0.06 -0.25 -0.56 -1.0
B 0.11 0.04 -0.13 -0.45 -0.88
C 0.44 0.38 0.19 -0.11 -0.55
D 1.0 0.93 0.75 0.43 0.0
E 1.77 1.71 1.52 1.21 0.77
EOD

set grid front lw 1.5 lt -1 lc rgb 'white'
plot $data matrix rowheaders columnheaders w image not
</code></pre>
<p><img src="https://i.imgur.com/08eJtZ7.png" alt="" /></p>
<p><code>xy</code> に gridline を引いてもちょうど 0.5 ずれた, セルの真ん中に引くようになってしまう.
なぜならセルはちょうど格子点 \( (x, y) \) に対して, \( (x-0.5, y-0.5) \ldots (x+0.5, y+0.5) \)
という矩形領域を占めているためである.</p>
<p>ちょうど 0.5 ずらした格子線を手に入れるために小目盛り (minor tics) を利用する.
ただし <code>xy</code> の大目盛りがラベルのために使われている (数値で指定されていない) ときは小目盛りは使えないことになっているので,
<code>x2y2</code> を使う.</p>
<p>まず <code>x2, y2</code> を宣言し <code>set link</code> で <code>xy</code> と同期させる.
これに小目盛り <code>mx2, my2</code> を <code>interval=2</code> で宣言することで, ちょうど半分に分割する目盛りを作れる.
<code>grid</code> の引数に <code>mx2tics, my2tics</code> を追加すればよい.</p>
<p>変更点だけ書き出すと次の通り.</p>
<pre><code class="language-diff">+set x2tics
+set y2tics
+set link x2
+set link y2
+set mx2tics 2
+set my2tics 2
-set grid front lw 1.5 lt -1 lc rgb 'white'
+set grid front mx2tics my2tics lw 1.5 lt -1 lc rgb 'white'
</code></pre>
<p>最後に余計なラベルや刻み線を消す処理を追加して結局</p>
<pre><code class="language-bash">$data &lt;&lt; EOD
X a b c d e
A 0.0 -0.06 -0.25 -0.56 -1.0
B 0.11 0.04 -0.13 -0.45 -0.88
C 0.44 0.38 0.19 -0.11 -0.55
D 1.0 0.93 0.75 0.43 0.0
E 1.77 1.71 1.52 1.21 0.77
EOD

set xtics scale 0  # 刻み線の長さ
set ytics scale 0
set x2tics format '' scale 0.01  # こちらもゼロにしたいがすると格子線まで消えてしまうので
set y2tics format '' scale 0.01
set link x2
set link y2
set mx2tics 2
set my2tics 2
set grid front mx2tics my2tics lw 1.5 lt -1 lc rgb 'white'
plot $data matrix rowheaders columnheaders w image not
</code></pre>
<p><img src="https://i.imgur.com/LFQu9gC.png" alt="" /></p>
<p>となった.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="横向き棒グラフ"><a class="header" href="#横向き棒グラフ">横向き棒グラフ</a></h1>
<h2 id="概要-5"><a class="header" href="#概要-5">概要</a></h2>
<p>横向きの棒グラフを描画したい.
通常の <code>with boxes</code> による棒グラフの描画は必ず縦向きであるが
カテゴリカルデータであって x 軸にラベルを表示する場合,
そのラベルが長いとラベル同士が重なったり見切れてしまい見づらい.
y 軸にラベルを表示して棒グラフを横向き（水平方向）にすることでこれを解決する.</p>
<p><img src="https://i.imgur.com/AtUimHD.png" alt="" /></p>
<p>これを</p>
<p><img src="https://i.imgur.com/CSRcoGq.png" alt="" /></p>
<p>こうしたい.</p>
<h2 id="参考-3"><a class="header" href="#参考-3">参考</a></h2>
<ul>
<li><a href="https://stackoverflow.com/questions/62848395/horizontal-bar-chart-in-gnuplot">Horizontal bar chart in gnuplot - Stack Overflow</a></li>
<li>[boxxyerror - gnuplot](http://www.gnuplot.info/docs_6.0/loc4843.html</li>
</ul>
<h2 id="手法-3"><a class="header" href="#手法-3">手法</a></h2>
<p>直接に横向きの棒グラフを描画する機能は gnuplot にはない.
ただし比較的自由に矩形を描画することは <code>with boxxyerror</code> を使うことで可能.
これを利用（悪用）して横向きの棒グラフを描画する.</p>
<h2 id="example-11"><a class="header" href="#example-11">Example</a></h2>
<h3 id="データ-datatxt"><a class="header" href="#データ-datatxt">データ (data.txt)</a></h3>
<pre><code>apple 100
banana 200
candy 250
</code></pre>
<h3 id="source-code-5"><a class="header" href="#source-code-5">Source Code</a></h3>
<pre><code class="language-bash">set terminal pngcairo size 800,600 enhanced font "Arial,12"
set output 'test.png'

# tics style
set style line 11 lc rgb '#808080' lt 1 lw 3
set border 0 back ls 11
set tics out nomirror
set style line 12 lc rgb '#808080' lt 0 lw 1

# grid style
set grid back ls 12

# box style
set style fill solid 0.5 border lc rgb '#55aaff'
set style line 1 lc rgb '#77ccff'

set yrange [0:*]
set xrange [0:*]
set style fill solid
unset key

myBoxWidth = 0.9
set offsets 0,0,0.5-myBoxWidth/2.,0.5

plot 'data.txt' using (0.5*$2):0:(0.5*$2):(myBoxWidth/2.):ytic(1) with boxxyerror fillcolor ls 1
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
